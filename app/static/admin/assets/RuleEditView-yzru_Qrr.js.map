{"version":3,"file":"RuleEditView-yzru_Qrr.js","sources":["../../src/views/underwriting/RuleEditView.vue"],"sourcesContent":["# 核保规则编辑页面\n<template>\n  <div class=\"rule-edit-page\">\n    <!-- 页面标题 -->\n    <div class=\"page-header\">\n      <div class=\"header-left\">\n        <BaseButton @click=\"router.back()\">返回</BaseButton>\n        <h1>{{ isEdit ? '编辑规则' : '新增规则' }}</h1>\n      </div>\n      <div class=\"header-actions\">\n        <BaseButton @click=\"handleCancel\">取消</BaseButton>\n        <BaseButton type=\"primary\" @click=\"handleSave\">保存</BaseButton>\n      </div>\n    </div>\n\n    <!-- 表单内容 -->\n    <div class=\"form-container\">\n      <div class=\"form-item\">\n        <label>规则名称</label>\n        <BaseInput\n          v-model=\"formData.name\"\n          placeholder=\"请输入规则名称\"\n          :maxlength=\"50\"\n        />\n        <div class=\"form-error\" v-if=\"formErrors.name\">\n          {{ formErrors.name }}\n        </div>\n      </div>\n\n      <div class=\"form-item\">\n        <label>版本号</label>\n        <BaseInput\n          v-model=\"formData.version\"\n          placeholder=\"请输入版本号\"\n          :maxlength=\"30\"\n          :disabled=\"isEdit\"\n        />\n        <div class=\"form-error\" v-if=\"formErrors.version\">\n          {{ formErrors.version }}\n        </div>\n      </div>\n\n      <div class=\"form-item\">\n        <label>备注</label>\n        <BaseInput\n          v-model=\"formData.remark\"\n          type=\"textarea\"\n          placeholder=\"请输入备注信息\"\n          :rows=\"3\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, onMounted, computed } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport type { Rule, RuleForm } from '@/types/underwriting'\nimport { get, post, put } from '@/utils/request'\nimport { showToast } from '@/utils/toast'\n\nconst router = useRouter()\nconst route = useRoute()\nconst ruleId = route.params.id\n\n// 是否是编辑模式\nconst isEdit = computed(() => !!ruleId)\n\n// 表单数据\nconst formData = reactive<RuleForm>({\n  name: '',\n  version: '',\n  remark: ''\n})\n\n// 表单错误信息\nconst formErrors = reactive({\n  name: '',\n  version: ''\n})\n\n// 加载规则详情\nconst loadRuleDetail = async () => {\n  if (!isEdit.value) return\n\n  try {\n    const res = await get(`/api/v1/underwriting/rules/${ruleId}`)\n    if (res.code === 200) {\n      const rule = res.data\n      formData.name = rule.name\n      formData.version = rule.version\n      formData.remark = rule.remark\n    } else {\n      showToast('error', res.message || '加载失败')\n    }\n  } catch (error) {\n    console.error('加载规则详情失败:', error)\n    showToast('error', '加载失败')\n  }\n}\n\n// 表单验证\nconst validateForm = () => {\n  let valid = true\n  formErrors.name = ''\n  formErrors.version = ''\n\n  if (!formData.name) {\n    formErrors.name = '请输入规则名称'\n    valid = false\n  }\n\n  if (!formData.version) {\n    formErrors.version = '请输入版本号'\n    valid = false\n  }\n\n  return valid\n}\n\n// 保存\nconst handleSave = async () => {\n  if (!validateForm()) return\n\n  try {\n    const data = {\n      name: formData.name,\n      version: formData.version,\n      remark: formData.remark\n    }\n\n    let res\n    if (isEdit.value) {\n      res = await put(`/api/v1/underwriting/rules/${ruleId}`, data)\n    } else {\n      res = await post('/api/v1/underwriting/rules', data)\n    }\n\n    if (res.code === 200) {\n      showToast('success', isEdit.value ? '更新成功' : '创建成功')\n      router.back()\n    } else {\n      showToast('error', res.message || (isEdit.value ? '更新失败' : '创建失败'))\n    }\n  } catch (error) {\n    console.error(isEdit.value ? '更新规则失败:' : '创建规则失败:', error)\n    showToast('error', isEdit.value ? '更新失败' : '创建失败')\n  }\n}\n\n// 取消\nconst handleCancel = () => {\n  router.back()\n}\n\n// 初始化\nonMounted(() => {\n  loadRuleDetail()\n})\n</script>\n\n<style scoped>\n.rule-edit-page {\n  padding: var(--spacing-lg);\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: var(--spacing-lg);\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-md);\n}\n\n.header-left h1 {\n  margin: 0;\n  font-size: var(--font-size-xl);\n  color: var(--color-text-primary);\n}\n\n.header-actions {\n  display: flex;\n  gap: var(--spacing-sm);\n}\n\n.form-container {\n  background: var(--color-bg-container);\n  border-radius: var(--border-radius-lg);\n  padding: var(--spacing-lg);\n  max-width: 600px;\n}\n\n.form-item {\n  margin-bottom: var(--spacing-lg);\n}\n\n.form-item label {\n  display: block;\n  margin-bottom: var(--spacing-sm);\n  color: var(--color-text-secondary);\n}\n\n.form-error {\n  margin-top: var(--spacing-xs);\n  color: var(--color-error);\n  font-size: var(--font-size-sm);\n}\n</style> "],"names":["router","useRouter","ruleId","useRoute","isEdit","computed","formData","reactive","formErrors","loadRuleDetail","res","get","rule","showToast","error","validateForm","valid","handleSave","data","put","post","handleCancel","onMounted"],"mappings":"kgBA8DA,MAAMA,EAASC,EAAU,EAEnBC,EADQC,EAAS,EACF,OAAO,GAGtBC,EAASC,EAAS,IAAM,CAAC,CAACH,CAAM,EAGhCI,EAAWC,EAAmB,CAClC,KAAM,GACN,QAAS,GACT,OAAQ,EAAA,CACT,EAGKC,EAAaD,EAAS,CAC1B,KAAM,GACN,QAAS,EAAA,CACV,EAGKE,EAAiB,SAAY,CAC7B,GAACL,EAAO,MAER,GAAA,CACF,MAAMM,EAAM,MAAMC,EAAI,8BAA8BT,CAAM,EAAE,EACxD,GAAAQ,EAAI,OAAS,IAAK,CACpB,MAAME,EAAOF,EAAI,KACjBJ,EAAS,KAAOM,EAAK,KACrBN,EAAS,QAAUM,EAAK,QACxBN,EAAS,OAASM,EAAK,MAAA,MAEbC,EAAA,QAASH,EAAI,SAAW,MAAM,QAEnCI,EAAO,CACN,QAAA,MAAM,YAAaA,CAAK,EAChCD,EAAU,QAAS,MAAM,CAAA,CAE7B,EAGME,EAAe,IAAM,CACzB,IAAIC,EAAQ,GACZ,OAAAR,EAAW,KAAO,GAClBA,EAAW,QAAU,GAEhBF,EAAS,OACZE,EAAW,KAAO,UACVQ,EAAA,IAGLV,EAAS,UACZE,EAAW,QAAU,SACbQ,EAAA,IAGHA,CACT,EAGMC,EAAa,SAAY,CACzB,GAACF,IAED,GAAA,CACF,MAAMG,EAAO,CACX,KAAMZ,EAAS,KACf,QAASA,EAAS,QAClB,OAAQA,EAAS,MACnB,EAEI,IAAAI,EACAN,EAAO,MACTM,EAAM,MAAMS,EAAI,8BAA8BjB,CAAM,GAAIgB,CAAI,EAEtDR,EAAA,MAAMU,EAAK,6BAA8BF,CAAI,EAGjDR,EAAI,OAAS,KACfG,EAAU,UAAWT,EAAO,MAAQ,OAAS,MAAM,EACnDJ,EAAO,KAAK,GAEZa,EAAU,QAASH,EAAI,UAAYN,EAAO,MAAQ,OAAS,OAAO,QAE7DU,EAAO,CACd,QAAQ,MAAMV,EAAO,MAAQ,UAAY,UAAWU,CAAK,EACzDD,EAAU,QAAST,EAAO,MAAQ,OAAS,MAAM,CAAA,CAErD,EAGMiB,EAAe,IAAM,CACzBrB,EAAO,KAAK,CACd,EAGA,OAAAsB,EAAU,IAAM,CACCb,EAAA,CAAA,CAChB"}