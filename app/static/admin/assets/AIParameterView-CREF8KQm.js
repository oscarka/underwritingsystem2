import{d as J,a as p,k as M,x as N,p as K,y as W,b as u,e as l,g as n,w as f,F as S,f as z,A as X,aA as Y,o as i,i as g,t as m,n as Z,l as b}from"./vue-vendor-hvhEjQgQ.js";import{u as ee}from"./useMessage-CiNUiv7K.js";import{g as ae,a as le,b as te,c as se,u as re,d as oe}from"./underwriting-WGKpY2Tf.js";import{b as V,c as x,e as C,f as ne,h as de,_ as ue}from"./index-soUPKp6E.js";const ie={class:"ai-parameter-page"},pe={class:"page-header"},me={class:"search-bar"},ve={class:"parameter-table"},_e={key:0,class:"loading-wrapper"},fe={key:1,class:"empty-state"},ce={key:2},ye={class:"pagination"},ge={class:"form"},Ve={class:"form-item"},ke={key:0,class:"form-error"},he={class:"form-item"},we={key:0,class:"form-error"},be={class:"form-item"},xe={key:0,class:"form-error"},Ce={class:"form-item"},Be={key:0,class:"form-error"},Ue={class:"form-item"},Pe=J({__name:"AIParameterView",setup(Se){X();const D=Y(),o=ee(),d=p({name:"",parameter_type_id:void 0,rule_id:void 0,page:1,pageSize:10}),c=p(1),B=p(10),k=p(0),y=p([]),U=p(!1),A=p([]),E=p([]),I=M(()=>A.value.map(a=>({label:a.name,value:a.id}))),T=M(()=>E.value.map(a=>({label:a.name,value:a.id}))),v=async()=>{U.value=!0;try{const a=await ae({page:c.value,pageSize:B.value,name:d.value.name||void 0,parameter_type_id:d.value.parameter_type_id,rule_id:d.value.rule_id});a.code===200?(y.value=a.data.list||[],k.value=a.data.total||0):(o.error(a.message||"加载失败"),y.value=[],k.value=0)}catch(a){console.error("加载参数列表失败:",a),o.error(a.message||"加载失败"),y.value=[],k.value=0}finally{U.value=!1}},R=async()=>{try{const a=await le();a.code===200?A.value=a.data:o.error(a.message||"获取参数类型失败")}catch(a){console.error("获取参数类型失败:",a),o.error(a.message||"获取参数类型失败")}},L=async()=>{try{const a=await te();a.code===200?E.value=a.data:o.error(a.message||"获取规则列表失败")}catch(a){console.error("获取规则列表失败:",a),o.error(a.message||"获取规则列表失败")}},q=()=>{c.value=1,v()},F=()=>{d.value.name="",d.value.parameter_type_id=void 0,d.value.rule_id=void 0,c.value=1,v()},$=()=>{v()},_=p(!1),h=p("add"),w=p(),s=N({name:"",parameter_type_id:void 0,rule_id:void 0,value:"",description:void 0,status:"enabled"}),r=N({name:"",parameter_type_id:"",rule_id:"",value:""}),O=()=>{let a=!0;return r.name="",r.parameter_type_id="",r.rule_id="",r.value="",s.name||(r.name="请输入参数名称",a=!1),s.parameter_type_id||(r.parameter_type_id="请选择参数类型",a=!1),s.rule_id||(r.rule_id="请选择核保规则",a=!1),s.value||(r.value="请输入参数值",a=!1),a},Q=()=>{h.value="add",w.value=void 0,s.name="",s.parameter_type_id=void 0,s.rule_id=void 0,s.value="",s.description=void 0,s.status="enabled",_.value=!0},j=a=>{h.value="edit",w.value=a.id,s.name=a.name,s.parameter_type_id=a.parameter_type_id,s.rule_id=a.rule_id,s.value=a.value,s.description=a.description,s.status=a.status,_.value=!0},G=async a=>{try{await o.confirm(`确定要删除参数"${a.name}"吗？`);const e=await oe(a.id);e.code===200?(o.success("删除成功"),v()):o.error(e.message||"删除失败")}catch(e){console.error("删除失败:",e),o.error(e.message||"删除失败")}},H=async()=>{if(O())try{const a={name:s.name,parameter_type_id:s.parameter_type_id,rule_id:s.rule_id,value:s.value,description:s.description||"",status:s.status};if(h.value==="add"){const e=await se(a);e.code===200?(o.success("创建成功"),_.value=!1,v()):o.error(e.message||"创建失败")}else if(w.value){const e=await re(w.value,a);e.code===200?(o.success("更新成功"),_.value=!1,v()):o.error(e.message||"更新失败")}}catch(a){console.error("保存失败:",a),o.error(a.message||"保存失败")}};return K(()=>D.query.refresh,()=>{D.query.refresh&&v()}),W(()=>{R(),L(),v()}),(a,e)=>(i(),u("div",ie,[l("div",pe,[e[12]||(e[12]=l("h1",null,"智核参数管理",-1)),n(V,{type:"primary",onClick:Q},{default:f(()=>e[11]||(e[11]=[g("新增参数")])),_:1})]),l("div",me,[n(x,{modelValue:d.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value.name=t),placeholder:"搜索参数名称",style:{width:"300px"}},null,8,["modelValue"]),n(C,{modelValue:d.value.parameter_type_id,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value.parameter_type_id=t),options:I.value,placeholder:"参数类型",style:{width:"200px"}},null,8,["modelValue","options"]),n(C,{modelValue:d.value.rule_id,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value.rule_id=t),options:T.value,placeholder:"核保规则",style:{width:"200px"}},null,8,["modelValue","options"]),n(V,{onClick:q},{default:f(()=>e[13]||(e[13]=[g("搜索")])),_:1}),n(V,{onClick:F},{default:f(()=>e[14]||(e[14]=[g("重置")])),_:1})]),l("div",ve,[U.value?(i(),u("div",_e,[(i(),u(S,null,z(5,t=>l("div",{class:"skeleton-row",key:t},[(i(),u(S,null,z(6,P=>l("div",{class:"skeleton-cell",key:P})),64))])),64))])):y.value.length?(i(),u("table",ce,[e[18]||(e[18]=l("thead",null,[l("tr",null,[l("th",null,"参数名称"),l("th",null,"参数类型"),l("th",null,"核保规则"),l("th",null,"参数值"),l("th",null,"状态"),l("th",null,"创建时间"),l("th",null,"更新时间"),l("th",null,"操作")])],-1)),l("tbody",null,[(i(!0),u(S,null,z(y.value,t=>(i(),u("tr",{key:t.id},[l("td",null,m(t.name),1),l("td",null,m(t.parameter_type_name),1),l("td",null,m(t.rule_name),1),l("td",null,m(t.value),1),l("td",null,[l("span",{class:Z(["status-badge",t.status==="enabled"?"ENABLED":"DISABLED"])},m(t.status==="enabled"?"启用":"禁用"),3)]),l("td",null,m(t.created_at),1),l("td",null,m(t.updated_at),1),l("td",null,[n(V,{size:"small",onClick:P=>j(t)},{default:f(()=>e[16]||(e[16]=[g("编辑")])),_:2},1032,["onClick"]),n(V,{type:"danger",size:"small",onClick:P=>G(t)},{default:f(()=>e[17]||(e[17]=[g("删除")])),_:2},1032,["onClick"])])]))),128))])])):(i(),u("div",fe,e[15]||(e[15]=[l("span",{class:"icon"},"📭",-1),l("p",null,"暂无数据",-1)]))),l("div",ye,[n(ne,{current:c.value,"onUpdate:current":e[3]||(e[3]=t=>c.value=t),pageSize:B.value,"onUpdate:pageSize":e[4]||(e[4]=t=>B.value=t),total:k.value,onChange:$},null,8,["current","pageSize","total"])])]),n(de,{modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=t=>_.value=t),title:h.value==="add"?"新增参数":"编辑参数",width:"500px",onConfirm:H},{default:f(()=>[l("div",ge,[l("div",Ve,[e[19]||(e[19]=l("label",null,"参数名称",-1)),n(x,{modelValue:s.name,"onUpdate:modelValue":e[5]||(e[5]=t=>s.name=t),placeholder:"请输入参数名称",maxlength:100},null,8,["modelValue"]),r.name?(i(),u("div",ke,m(r.name),1)):b("",!0)]),l("div",he,[e[20]||(e[20]=l("label",null,"参数类型",-1)),n(C,{modelValue:s.parameter_type_id,"onUpdate:modelValue":e[6]||(e[6]=t=>s.parameter_type_id=t),options:I.value,placeholder:"请选择参数类型"},null,8,["modelValue","options"]),r.parameter_type_id?(i(),u("div",we,m(r.parameter_type_id),1)):b("",!0)]),l("div",be,[e[21]||(e[21]=l("label",null,"核保规则",-1)),n(C,{modelValue:s.rule_id,"onUpdate:modelValue":e[7]||(e[7]=t=>s.rule_id=t),options:T.value,placeholder:"请选择核保规则"},null,8,["modelValue","options"]),r.rule_id?(i(),u("div",xe,m(r.rule_id),1)):b("",!0)]),l("div",Ce,[e[22]||(e[22]=l("label",null,"参数值",-1)),n(x,{modelValue:s.value,"onUpdate:modelValue":e[8]||(e[8]=t=>s.value=t),type:"textarea",placeholder:"请输入参数值",maxlength:500,rows:4},null,8,["modelValue"]),r.value?(i(),u("div",Be,m(r.value),1)):b("",!0)]),l("div",Ue,[e[23]||(e[23]=l("label",null,"参数描述",-1)),n(x,{modelValue:s.description,"onUpdate:modelValue":e[9]||(e[9]=t=>s.description=t),type:"textarea",placeholder:"请输入参数描述",maxlength:500,rows:4},null,8,["modelValue"])])])]),_:1},8,["modelValue","title"])]))}}),Ie=ue(Pe,[["__scopeId","data-v-145ce174"]]);export{Ie as default};
//# sourceMappingURL=AIParameterView-CREF8KQm.js.map
